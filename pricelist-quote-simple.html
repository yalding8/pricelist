<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>å¼‚ä¹¡å¥½å±…æŠ¥ä»·å•</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'PingFang SC', sans-serif; background: #f5f5f5; }
        .quote-card { max-width: 750px; margin: 0 auto; background: white; }
        .header { background: linear-gradient(135deg, #FF5A5F 0%, #E54850 100%); color: white; padding: 32px 24px; text-align: center; }
        .section { padding: 24px; border-bottom: 1px solid #f0f0f0; }
        .section-title { font-size: 18px; font-weight: 600; margin-bottom: 16px; }
        .price-row { display: flex; justify-content: space-between; padding: 12px 0; }
        .discount-group { background: #f8f9fa; border-radius: 12px; padding: 16px; margin: 16px 0; }
        .payer-badge { font-size: 12px; padding: 3px 10px; border-radius: 4px; margin-left: 8px; }
        .payer-badge.landlord { background: #E3F2FD; color: #1976D2; }
        .payer-badge.uhomes { background: #FFE5E5; color: #FF5A5F; }
        .discount-item { display: flex; justify-content: space-between; padding: 8px 0 8px 16px; }
        .discount-amount { color: #4CAF50; font-weight: 500; }
        .final-price-box { background: linear-gradient(135deg, #FFF3CD 0%, #FFE5E5 100%); padding: 24px; text-align: center; }
        .final-price-value { font-size: 36px; font-weight: 700; color: #FF5A5F; }
        .gifts-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-top: 12px; }
        .gift-card { background: white; border: 2px solid #f0f0f0; border-radius: 8px; padding: 12px; display: flex; align-items: center; }
        .gift-icon { font-size: 32px; margin-right: 12px; }
        .gift-name { font-size: 14px; font-weight: 600; }
        .gift-value { font-size: 16px; font-weight: 700; color: #FF5A5F; }
    </style>
</head>
<body>
    <div class="quote-card">
        <div class="header">
            <div style="font-size: 20px; font-weight: 600; margin-bottom: 12px;">å¼‚ä¹¡å¥½å±…</div>
            <h1 style="font-size: 24px;">ğŸ  ä¸“å±æŠ¥ä»·å•</h1>
            <div style="font-size: 18px; margin-top: 8px;">{{ property.property_name }}</div>
        </div>

        <div class="section">
            <div class="section-title">ğŸ“‹ æˆ¿æºä¿¡æ¯</div>
            <div class="price-row"><span>æˆ·å‹</span><strong>{{ property.room_type }}</strong></div>
            <div class="price-row"><span>ç§ŸæœŸ</span><strong>{{ property.lease_period_text }}</strong></div>
            <div class="price-row"><span>åœ°å€</span><strong>{{ property.address }}</strong></div>
        </div>

        <div class="section">
            <div class="section-title">ğŸ’° ä»·æ ¼æ˜ç»†</div>
            <div class="price-row" style="font-size: 18px; font-weight: 600; border-bottom: 2px solid #f0f0f0; margin-bottom: 16px;">
                <span>æˆ¿ä¸œåŸä»·</span>
                <strong>Â£{{ original_annual_price|int }}/å¹´</strong>
            </div>

            {% if landlord_discounts %}
            <div class="discount-group">
                <div style="font-size: 16px; font-weight: 600; margin-bottom: 12px;">
                    ğŸ’³ æˆ¿ä¸œä¼˜æƒ 
                    <span class="payer-badge landlord">ç”±æˆ¿ä¸œç»“ç®—</span>
                </div>
                {% for discount in landlord_discounts %}
                <div class="discount-item">
                    <span>{{ discount.name }}</span>
                    <span class="discount-amount">-Â£{{ discount.amount|int }}</span>
                </div>
                {% endfor %}
                <div class="price-row" style="border-top: 1px dashed #ddd; margin-top: 8px; padding-top: 12px; font-weight: 600;">
                    <span>å°è®¡</span>
                    <span class="discount-amount">-Â£{{ total_landlord_discount|int }}</span>
                </div>
            </div>
            {% endif %}

            {% if uhomes_subsidies %}
            <div class="discount-group">
                <div style="font-size: 16px; font-weight: 600; margin-bottom: 12px;">
                    ğŸ å¼‚ä¹¡è¡¥è´´
                    <span class="payer-badge uhomes">ç”±å¼‚ä¹¡å¥½å±…ç»“ç®—</span>
                </div>
                {% for subsidy in uhomes_subsidies %}
                <div class="discount-item">
                    <span>{{ subsidy.name }}</span>
                    <span class="discount-amount">-Â£{{ subsidy.amount|int }}</span>
                </div>
                {% endfor %}
                <div class="price-row" style="border-top: 1px dashed #ddd; margin-top: 8px; padding-top: 12px; font-weight: 600;">
                    <span>å°è®¡</span>
                    <span class="discount-amount">-Â£{{ total_uhomes_subsidy|int }}</span>
                </div>
            </div>
            {% endif %}
        </div>

        {% if selected_gifts %}
        <div class="section">
            <div class="section-title">ğŸ å¼‚ä¹¡èµ é€ç¤¼åŒ…</div>
            <div class="gifts-grid">
                {% for gift in selected_gifts %}
                <div class="gift-card">
                    <div class="gift-icon">{{ gift.icon }}</div>
                    <div>
                        <div class="gift-name">{{ gift.name }}</div>
                        <div class="gift-value">ä»·å€¼Â£{{ gift.value|int }}</div>
                        <div style="font-size: 10px; color: #666;">{{ gift.category_name }}</div>
                    </div>
                </div>
                {% endfor %}
            </div>
            <div style="background: #FFF9E5; padding: 12px 16px; margin-top: 16px; border-radius: 4px; border-left: 4px solid #FFB800;">
                <span style="font-size: 15px; color: #856404;">ğŸ‰ ç¤¼åŒ…æ€»ä»·å€¼:</span>
                <span style="font-size: 20px; font-weight: 700; color: #FF5A5F; margin-left: 8px;">Â£{{ total_gifts_value|int }}</span>
            </div>
        </div>
        {% endif %}

        <div class="final-price-box">
            <div style="font-size: 16px; color: #666; margin-bottom: 8px;">âœ¨ æ‚¨çš„ç§Ÿé‡‘åˆ°æ‰‹ä»·</div>
            <div class="final-price-value">Â£{{ final_annual_price|int }}/å¹´</div>
            <div style="font-size: 18px; color: #666;">(Â£{{ final_weekly_price|int }}/å‘¨)</div>
            <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid rgba(0,0,0,0.1); display: flex; justify-content: space-around;">
                <div style="text-align: center;">
                    <div style="font-size: 22px; font-weight: 600; color: #4CAF50;">Â£{{ total_savings|int }}</div>
                    <div style="font-size: 13px; color: #666; margin-top: 4px;">ğŸ’° æ€»èŠ‚çœé‡‘é¢</div>
                </div>
                <div style="text-align: center;">
                    <div style="font-size: 22px; font-weight: 600; color: #4CAF50;">{{ savings_rate|round(1) }}%</div>
                    <div style="font-size: 13px; color: #666; margin-top: 4px;">ğŸ“Š ä¼˜æƒ å¹…åº¦</div>
                </div>
            </div>
        </div>

        {% if advisor %}
        <div class="section">
            <div class="section-title">ğŸ‘¤ æ‚¨çš„ä¸“å±é¡¾é—®</div>
            <div style="display: flex; align-items: center; padding: 20px; background: #f8f9fa; border-radius: 12px;">
                <div style="width: 64px; height: 64px; border-radius: 50%; background: linear-gradient(135deg, #FF5A5F 0%, #E54850 100%); display: flex; align-items: center; justify-center; color: white; font-size: 24px; font-weight: 600; margin-right: 16px;">{{ advisor.avatar_initial }}</div>
                <div style="flex: 1;">
                    <div style="font-size: 18px; font-weight: 600; margin-bottom: 6px;">{{ advisor.name }}</div>
                    <div style="font-size: 14px; color: #666; margin: 4px 0;">ğŸ“± {{ advisor.phone }}</div>
                    <div style="font-size: 14px; color: #666; margin: 4px 0;">ğŸ’¬ {{ advisor.wechat_id }}</div>
                </div>
            </div>
        </div>
        {% endif %}

        <div style="padding: 20px 24px; text-align: center; font-size: 13px; color: #999; background: #f8f9fa;">
            <p>â° æŠ¥ä»·æœ‰æ•ˆæœŸ: <span style="color: #FF5A5F; font-weight: 600;">{{ valid_until }}</span></p>
            <p style="margin-top: 8px; color: #666;">å¼‚ä¹¡å¥½å±… Â· ç•™å­¦ç”Ÿæµ·å¤–çš„å®¶</p>
        </div>
    </div>
</body>
</html>
